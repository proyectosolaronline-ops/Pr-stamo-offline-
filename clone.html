<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>TEST - Datos Reales desde Google Sheets</title>
    <style>
        * { margin: 0; padding: 0; box-sizing: border-box; }
        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            min-height: 100vh;
            padding: 20px;
        }
        .container {
            max-width: 1100px;
            margin: 0 auto;
            background: white;
            border-radius: 20px;
            padding: 30px;
            box-shadow: 0 20px 60px rgba(0,0,0,0.3);
        }
        h1 {
            color: #667eea;
            text-align: center;
            margin-bottom: 10px;
            font-size: 2em;
        }
        .subtitle {
            text-align: center;
            color: #666;
            margin-bottom: 30px;
            font-size: 1em;
        }
        .box {
            background: #f8f9fa;
            padding: 25px;
            margin: 20px 0;
            border-radius: 15px;
            border: 2px solid #e0e0e0;
        }
        .box h2 {
            color: #667eea;
            margin-bottom: 15px;
            font-size: 1.4em;
        }
        button {
            background: #667eea;
            color: white;
            border: none;
            padding: 14px 28px;
            border-radius: 10px;
            cursor: pointer;
            margin: 5px;
            font-weight: 600;
            font-size: 1em;
            transition: all 0.3s;
            box-shadow: 0 4px 10px rgba(102, 126, 234, 0.3);
        }
        button:hover {
            background: #5568d3;
            transform: translateY(-2px);
            box-shadow: 0 6px 15px rgba(102, 126, 234, 0.4);
        }
        button:disabled {
            background: #ccc;
            cursor: not-allowed;
            transform: none;
        }
        .btn-danger {
            background: #dc3545;
            box-shadow: 0 4px 10px rgba(220, 53, 69, 0.3);
        }
        .btn-danger:hover {
            background: #c82333;
        }
        .btn-success {
            background: #28a745;
            box-shadow: 0 4px 10px rgba(40, 167, 69, 0.3);
        }
        .btn-success:hover {
            background: #218838;
        }
        .success {
            color: #28a745;
            font-weight: bold;
            padding: 12px;
            background: #d4edda;
            border-radius: 8px;
            margin: 8px 0;
            border-left: 4px solid #28a745;
        }
        .error {
            color: #dc3545;
            font-weight: bold;
            padding: 12px;
            background: #f8d7da;
            border-radius: 8px;
            margin: 8px 0;
            border-left: 4px solid #dc3545;
        }
        .warning {
            color: #856404;
            padding: 12px;
            background: #fff3cd;
            border-radius: 8px;
            margin: 8px 0;
            border-left: 4px solid #ffc107;
        }
        .info {
            color: #004085;
            padding: 12px;
            background: #cce5ff;
            border-radius: 8px;
            margin: 8px 0;
            border-left: 4px solid #007bff;
        }
        pre {
            background: #2d2d2d;
            color: #f8f8f2;
            padding: 15px;
            border-radius: 8px;
            overflow-x: auto;
            font-size: 0.9em;
            font-family: 'Courier New', monospace;
        }
        .table-compare {
            display: grid;
            grid-template-columns: 1fr 1fr 1fr;
            gap: 15px;
            margin: 20px 0;
        }
        .col {
            background: white;
            padding: 15px;
            border-radius: 10px;
            border: 2px solid #667eea;
        }
        .col h4 {
            color: #667eea;
            margin-bottom: 10px;
            text-align: center;
            font-size: 1.1em;
        }
        .row-item {
            padding: 10px;
            margin: 5px 0;
            background: #f8f9fa;
            border-radius: 5px;
            font-family: monospace;
            font-size: 0.9em;
        }
        .row-header {
            background: #667eea;
            color: white;
            font-weight: bold;
        }
        .loading {
            display: inline-block;
            width: 20px;
            height: 20px;
            border: 3px solid rgba(102, 126, 234, 0.3);
            border-radius: 50%;
            border-top-color: #667eea;
            animation: spin 1s ease-in-out infinite;
            margin-right: 8px;
        }
        @keyframes spin {
            to { transform: rotate(360deg); }
        }
        .status-badge {
            display: inline-block;
            padding: 5px 12px;
            border-radius: 20px;
            font-size: 0.85em;
            font-weight: 600;
            margin-left: 10px;
        }
        .status-online {
            background: #d4edda;
            color: #28a745;
        }
        .status-offline {
            background: #f8d7da;
            color: #dc3545;
        }
        .calc-result {
            background: white;
            padding: 20px;
            border-radius: 10px;
            margin-top: 15px;
            border: 2px solid #28a745;
        }
        .calc-result .item {
            display: flex;
            justify-content: space-between;
            padding: 8px 0;
            border-bottom: 1px solid #e0e0e0;
        }
        .calc-result .item:last-child {
            border-bottom: none;
            font-weight: bold;
            font-size: 1.1em;
            color: #667eea;
        }
    </style>
</head>
<body>
    <div class="container">
        <h1>üî¨ TEST - Datos Reales de Google Sheets</h1>
        <p class="subtitle">Verificar lectura correcta sin valores por defecto</p>
        
        <div class="box">
            <h2>üåê Estado de Conexi√≥n <span id="statusBadge" class="status-badge status-offline">Offline</span></h2>
            <button onclick="verificarConexion()" class="btn-success">üîç Verificar Conexi√≥n</button>
            <div id="conexionStatus"></div>
        </div>

        <div class="box">
            <h2>üìä Paso 1: Leer Datos de Google Sheets</h2>
            <button onclick="leerTodosLosDatos()">üì• Leer Datos Reales</button>
            <div id="datosReales"></div>
        </div>

        <div class="box">
            <h2>üìã Paso 2: Visualizar Mapeo (Fila por Fila)</h2>
            <button onclick="mostrarMapeo()">üîç Ver Mapeo Detallado</button>
            <div id="mapeoVisual"></div>
        </div>

        <div class="box">
            <h2>üíæ Paso 3: localStorage</h2>
            <button onclick="guardarEnCache()">üíæ Guardar en Cache</button>
            <button onclick="verCache()">üëÅÔ∏è Ver Cache</button>
            <button onclick="limpiarCache()" class="btn-danger">üóëÔ∏è Limpiar Cache</button>
            <div id="cacheStatus"></div>
        </div>

        <div class="box">
            <h2>üßÆ Paso 4: Probar C√°lculo</h2>
            <div style="margin: 15px 0;">
                <select id="testDias" style="padding: 10px; margin: 5px; border-radius: 8px; font-size: 1em; min-width: 150px;">
                    <option value="">-- Selecciona d√≠as --</option>
                </select>
                <input type="number" id="testCapital" value="5000" placeholder="Capital" 
                       style="padding: 10px; margin: 5px; border-radius: 8px; width: 150px; font-size: 1em;">
                <button onclick="calcularTest()">üìä Calcular</button>
            </div>
            <div id="calculoResult"></div>
        </div>
    </div>

    <script>
        const SHEET_ID = '19Viesr9Lhy347A9L03J_RuxftUhBduaYsBY206IO6X8';
        const CACHE_EXPIRY_HOURS = 24;
        
        let datosGlobales = {
            dias: null,
            capital: null,
            interes: null,
            banner: null,
            filasDias: null,
            filasInteres: null
        };

        // ============================================
        // FUNCIONES DE CACHE
        // ============================================
        
        function saveToCache(key, data) {
            const cacheData = {
                data: data,
                timestamp: new Date().getTime()
            };
            localStorage.setItem(`simulador_${key}`, JSON.stringify(cacheData));
            console.log(`‚úÖ Guardado en cache: simulador_${key}`, data);
        }

        function getFromCache(key) {
            try {
                const cached = localStorage.getItem(`simulador_${key}`);
                if (!cached) return null;
                
                const cacheData = JSON.parse(cached);
                
                // Verificar expiraci√≥n
                const now = new Date().getTime();
                const hoursDiff = (now - cacheData.timestamp) / (1000 * 60 * 60);
                
                if (hoursDiff > CACHE_EXPIRY_HOURS) {
                    console.warn(`‚ö†Ô∏è Cache expirado para ${key} (${hoursDiff.toFixed(1)} horas)`);
                    return null;
                }
                
                return cacheData.data;
            } catch (error) {
                console.error(`‚ùå Error al leer cache: ${key}`, error);
                return null;
            }
        }

        // ============================================
        // FUNCIONES DE LECTURA DE GOOGLE SHEETS
        // ============================================
        
        async function leerColumnaCompleta(nombreHoja) {
            const url = `https://docs.google.com/spreadsheets/d/${SHEET_ID}/gviz/tq?tqx=out:json&sheet=${nombreHoja}`;
            
            console.log(`üì• Leyendo hoja: ${nombreHoja}`);
            
            const controller = new AbortController();
            const timeout = setTimeout(() => controller.abort(), 5000);
            
            try {
                const response = await fetch(url, { signal: controller.signal });
                clearTimeout(timeout);
                
                if (!response.ok) {
                    throw new Error(`HTTP ${response.status}: ${response.statusText}`);
                }
                
                const text = await response.text();
                
                if (!text.includes('google.visualization.Query.setResponse')) {
                    throw new Error('Respuesta inv√°lida de Google Sheets');
                }
                
                const jsonStr = text.replace(/^[\s\S]*?setResponse\(/, '').replace(/\);[\s\S]*$/, '');
                const json = JSON.parse(jsonStr);
                
                const rows = json.table.rows || [];
                console.log(`‚úÖ ${nombreHoja}: ${rows.length} filas le√≠das`);
                
                return rows;
                
            } catch (error) {
                clearTimeout(timeout);
                console.error(`‚ùå Error en ${nombreHoja}:`, error);
                throw error;
            }
        }

        async function loadDiasFromSheet() {
            const rows = await leerColumnaCompleta('Dias');
            const valores = [];
            
            rows.forEach((row, idx) => {
                const valor = row?.c?.[0]?.v;
                
                // Saltar encabezado si es texto
                if (idx === 0 && isNaN(parseFloat(valor))) {
                    console.log(`  ‚è≠Ô∏è Saltando encabezado: "${valor}"`);
                    return;
                }
                
                const num = parseFloat(valor);
                if (!isNaN(num)) {
                    valores.push(num);
                }
            });
            
            if (valores.length === 0) {
                throw new Error('No se encontraron valores v√°lidos en hoja Dias');
            }
            
            console.log(`‚úÖ Dias cargados:`, valores);
            return valores;
        }

        async function loadCapitalFromSheet() {
            const rows = await leerColumnaCompleta('Capital');
            const valores = [];
            
            rows.forEach((row, idx) => {
                const valor = row?.c?.[0]?.v;
                
                // Saltar encabezado si es texto
                if (idx === 0 && isNaN(parseFloat(valor))) {
                    console.log(`  ‚è≠Ô∏è Saltando encabezado: "${valor}"`);
                    return;
                }
                
                const num = parseFloat(valor);
                if (!isNaN(num)) {
                    valores.push(num);
                }
            });
            
            if (valores.length === 0) {
                throw new Error('No se encontraron valores v√°lidos en hoja Capital');
            }
            
            console.log(`‚úÖ Capital cargado:`, valores);
            return valores;
        }

        async function loadInteresFromSheet() {
            console.log('üìä Cargando Interes con mapeo por fila...');
            
            const rowsDias = await leerColumnaCompleta('Dias');
            const rowsInteres = await leerColumnaCompleta('Interes');
            
            // Guardar para visualizaci√≥n
            datosGlobales.filasDias = rowsDias;
            datosGlobales.filasInteres = rowsInteres;
            
            const interesesObj = {};
            const maxFilas = Math.max(rowsDias.length, rowsInteres.length);
            
            for (let i = 0; i < maxFilas; i++) {
                const filaNum = i + 1;
                
                let diasValor = rowsDias[i]?.c?.[0]?.v;
                let interesValor = rowsInteres[i]?.c?.[0]?.v;
                const interesFormato = rowsInteres[i]?.c?.[0]?.f;
                
                console.log(`  Fila A${filaNum}: Dias=${diasValor}, Interes=${interesValor}, Formato=${interesFormato}`);
                
                // Saltar encabezado
                if (i === 0 && (isNaN(parseFloat(diasValor)) || isNaN(parseFloat(interesValor)))) {
                    console.log(`    ‚è≠Ô∏è Saltando encabezado`);
                    continue;
                }
                
                const diasNum = parseFloat(diasValor);
                let interesNum = parseFloat(interesValor);
                
                if (isNaN(diasNum) || isNaN(interesNum)) {
                    console.log(`    ‚ö†Ô∏è Valores inv√°lidos, saltando`);
                    continue;
                }
                
                // Detectar formato porcentaje
                if (interesFormato && interesFormato.includes('%')) {
                    interesNum = interesNum * 100;
                    console.log(`    ‚úÖ Convertido %: ${interesValor} ‚Üí ${interesNum}`);
                } else if (interesNum > 0 && interesNum < 1) {
                    interesNum = interesNum * 100;
                    console.log(`    ‚úÖ Convertido decimal: ${interesValor} ‚Üí ${interesNum}`);
                }
                
                interesesObj[diasNum] = interesNum;
                console.log(`    ‚úÖ Mapeado: ${diasNum} d√≠as ‚Üí ${interesNum}%`);
            }
            
            if (Object.keys(interesesObj).length === 0) {
                throw new Error('No se encontraron pares v√°lidos d√≠as-inter√©s');
            }
            
            console.log(`‚úÖ Objeto de intereses final:`, interesesObj);
            return interesesObj;
        }

        async function loadBannerFromSheet() {
            const rows = await leerColumnaCompleta('Banner');
            
            if (rows.length > 1) {
                const mensaje = rows[1]?.c?.[0]?.v || '';
                console.log(`‚úÖ Banner: "${mensaje}"`);
                return {
                    activo: mensaje.trim() !== '',
                    texto: mensaje
                };
            }
            
            return {
                activo: false,
                texto: ''
            };
        }

        // ============================================
        // FUNCIONES DE INTERFAZ
        // ============================================
        
        function actualizarEstadoConexion() {
            const isOnline = navigator.onLine;
            const badge = document.getElementById('statusBadge');
            
            if (isOnline) {
                badge.className = 'status-badge status-online';
                badge.textContent = 'Online';
            } else {
                badge.className = 'status-badge status-offline';
                badge.textContent = 'Offline';
            }
        }

        async function verificarConexion() {
            const div = document.getElementById('conexionStatus');
            div.innerHTML = '<p class="info"><span class="loading"></span>Verificando hojas en Google Sheets...</p>';
            
            const hojas = ['Dias', 'Capital', 'Interes', 'Banner'];
            let html = '<h3>Resultado de Verificaci√≥n:</h3>';
            
            for (const hoja of hojas) {
                try {
                    const rows = await leerColumnaCompleta(hoja);
                    html += `<div class="success">‚úÖ Hoja "${hoja}": ${rows.length} filas encontradas</div>`;
                } catch (error) {
                    html += `<div class="error">‚ùå Hoja "${hoja}": ${error.message}</div>`;
                    html += `<div class="warning">‚ö†Ô∏è Verifica que la hoja "${hoja}" exista en Google Sheets</div>`;
                }
            }
            
            div.innerHTML = html;
        }

        async function leerTodosLosDatos() {
            const div = document.getElementById('datosReales');
            div.innerHTML = '<p class="info"><span class="loading"></span>Leyendo datos de Google Sheets...</p>';
            
            let html = '<h3>üìä Datos Le√≠dos:</h3>';
            let todoCorrecto = true;
            
            try {
                // Dias
                html += '<p><span class="loading"></span>Leyendo Dias...</p>';
                const dias = await loadDiasFromSheet();
                datosGlobales.dias = dias;
                html += `<div class="success">‚úÖ DIAS: ${JSON.stringify(dias)}</div>`;
                
                // Capital
                html += '<p><span class="loading"></span>Leyendo Capital...</p>';
                const capital = await loadCapitalFromSheet();
                datosGlobales.capital = capital;
                html += `<div class="success">‚úÖ CAPITAL: ${JSON.stringify(capital)}</div>`;
                
                // Interes
                html += '<p><span class="loading"></span>Leyendo Interes...</p>';
                const interes = await loadInteresFromSheet();
                datosGlobales.interes = interes;
                html += `<div class="success">‚úÖ INTERES:<pre>${JSON.stringify(interes, null, 2)}</pre></div>`;
                
                // Banner
                html += '<p><span class="loading"></span>Leyendo Banner...</p>';
                const banner = await loadBannerFromSheet();
                datosGlobales.banner = banner;
                html += `<div class="success">‚úÖ BANNER: "${banner.texto}" (activo: ${banner.activo})</div>`;
                
                // Actualizar select de d√≠as
                const select = document.getElementById('testDias');
                select.innerHTML = '<option value="">-- Selecciona d√≠as --</option>';
                dias.forEach(d => {
                    select.innerHTML += `<option value="${d}">${d} d√≠as</option>`;
                });
                
                html += '<div class="success"><strong>üéâ Todos los datos le√≠dos correctamente desde Google Sheets</strong></div>';
                
            } catch (error) {
                todoCorrecto = false;
                html += `<div class="error">‚ùå Error: ${error.message}</div>`;
                html += `<div class="warning">‚ö†Ô∏è Verifica que las hojas existan y tengan datos v√°lidos en columna A</div>`;
            }
            
                
                // Actualizar select de capital
                const selectCapital = document.getElementById('testCapital');
                if (selectCapital && selectCapital.tagName === 'SELECT') {
                    selectCapital.innerHTML = '<option value="">-- Selecciona monto --</option>';
                    capital.forEach(c => {
                        selectCapital.innerHTML += `<option value="${c}">$${c.toLocaleString('es-MX')}</option>`;
                    });
                }
            div.innerHTML = html;
        }

        function mostrarMapeo() {
            const div = document.getElementById('mapeoVisual');
            
            if (!datosGlobales.filasDias || !datosGlobales.filasInteres) {
                div.innerHTML = '<div class="warning">‚ö†Ô∏è Primero lee los datos (Paso 1)</div>';
                return;
            }
            
            let html = '<h3>üîç Mapeo Fila por Fila:</h3>';
            html += '<div class="table-compare">';
            
            // Columna Dias
            html += '<div class="col"><h4>üìÖ Hoja "Dias"</h4>';
            datosGlobales.filasDias.forEach((row, idx) => {
                const valor = row?.c?.[0]?.v;
                const clase = (idx === 0 && isNaN(parseFloat(valor))) ? 'row-header' : 'row-item';
                html += `<div class="${clase}">A${idx + 1}: ${valor}</div>`;
            });
            html += '</div>';
            
            // Columna Interes
            html += '<div class="col"><h4>üìä Hoja "Interes"</h4>';
            datosGlobales.filasInteres.forEach((row, idx) => {
                const valor = row?.c?.[0]?.v;
                const formato = row?.c?.[0]?.f;
                const clase = (idx === 0 && isNaN(parseFloat(valor))) ? 'row-header' : 'row-item';
                html += `<div class="${clase}">A${idx + 1}: ${formato || valor}</div>`;
            });
            html += '</div>';
            
            // Resultado
            html += '<div class="col"><h4>‚úÖ Resultado</h4>';
            html += '<div class="row-header">Mapeo</div>';
            if (datosGlobales.interes) {
                Object.keys(datosGlobales.interes).forEach(dias => {
                    html += `<div class="row-item">${dias} d√≠as ‚Üí ${datosGlobales.interes[dias]}%</div>`;
                });
            }
            html += '</div>';
            
            html += '</div>';
            
            div.innerHTML = html;
        }

        function guardarEnCache() {
            if (!datosGlobales.dias || !datosGlobales.interes) {
                alert('‚ùå Primero lee los datos desde Google Sheets (Paso 1)');
                return;
            }
            
            try {
                saveToCache('dias', datosGlobales.dias);
                saveToCache('capital', datosGlobales.capital);
                saveToCache('interes', datosGlobales.interes);
                saveToCache('banner_config', datosGlobales.banner);
                
                alert('‚úÖ Datos guardados en localStorage');
                verCache();
            } catch (error) {
                alert('‚ùå Error al guardar: ' + error.message);
            }
        }

        function verCache() {
            const div = document.getElementById('cacheStatus');
            
            const dias = getFromCache('dias');
            const capital = getFromCache('capital');
            const interes = getFromCache('interes');
            const banner = getFromCache('banner_config');
            
            let html = '<h3>üì± Contenido de localStorage:</h3>';
            
            html += '<pre>';
            html += 'DIAS:\n';
            html += dias ? JSON.stringify(dias, null, 2) : '‚ùå No hay datos';
            html += '\n\n';
            
            html += 'CAPITAL:\n';
            html += capital ? JSON.stringify(capital, null, 2) : '‚ùå No hay datos';
            html += '\n\n';
            
            html += 'INTERES:\n';
            html += interes ? JSON.stringify(interes, null, 2) : '‚ùå No hay datos';
            html += '\n\n';
            
            html += 'BANNER:\n';
            html += banner ? JSON.stringify(banner, null, 2) : '‚ùå No hay datos';
            html += '</pre>';
            
            if (!dias && !capital && !interes && !banner) {
                html += '<div class="warning">‚ö†Ô∏è localStorage vac√≠o. Carga y guarda datos primero.</div>';
            }
            
            div.innerHTML = html;
        }

        function calcularTest() {
            const dias = parseInt(document.getElementById('testDias').value);
            const capital = parseFloat(document.getElementById('testCapital').value);
            const interes = datosGlobales.interes;
            const div = document.getElementById('calculoResult');
            
            if (!dias) {
                div.innerHTML = '<div class="warning">‚ö†Ô∏è Selecciona un plazo</div>';
                return;
            }
            
            if (!interes || Object.keys(interes).length === 0) {
                div.innerHTML = '<div class="error">‚ùå No hay datos de inter√©s. Lee los datos primero.</div>';
                return;
            }
            
            if (!(dias in interes)) {
                div.innerHTML = `<div class="error">‚ùå No hay tasa de inter√©s para ${dias} d√≠as</div>`;
                return;
            }
            
            const interesPorc = interes[dias];
            const interesTotal = capital * (interesPorc / 100);
            const totalPrestar = capital + interesTotal;
            const pagoDiario = totalPrestar / dias;
            
            div.innerHTML = `
                <div class="calc-result">
                    <h3 style="color: #667eea; margin-bottom: 15px;">‚úÖ Resultado del C√°lculo</h3>
                    <div class="item">
                        <span>üí∞ Capital:</span>
                        <span>$${capital.toLocaleString('es-MX', {minimumFractionDigits: 2, maximumFractionDigits: 2})}</span>
                    </div>
                    <div class="item">
                        <span>üìà Tasa de Inter√©s:</span>
                        <span>${interesPorc}%</span>
                    </div>
                    <div class="item">
                        <span>üìä Inter√©s Total:</span>
                        <span>$${interesTotal.toLocaleString('es-MX', {minimumFractionDigits: 2, maximumFractionDigits: 2})}</span>
                    </div>
                    <div class="item">
                        <span>üíµ Total a Pagar:</span>
                        <span>$${totalPrestar.toLocaleString('es-MX', {minimumFractionDigits: 2, maximumFractionDigits: 2})}</span>
                    </div>
                    <div class="item">
                        <span>üìÖ Plazo:</span>
                        <span>${dias} d√≠as</span>
                    </div>
                    <div class="item">
                        <span>üí≥ Pago Diario:</span>
                        <span>$${pagoDiario.toLocaleString('es-MX', {minimumFractionDigits: 2, maximumFractionDigits: 2})}</span>
                    </div>
                </div>
            `;
        }

        function limpiarCache() {
            if (confirm('¬øEst√°s seguro de limpiar TODO el localStorage?')) {
                localStorage.removeItem('simulador_dias');
                localStorage.removeItem('simulador_capital');
                localStorage.removeItem('simulador_interes');
                localStorage.removeItem('simulador_banner_config');
                alert('‚úÖ localStorage limpiado');
                verCache();
            }
        }

        // ============================================
        // EVENTOS
        // ============================================
        
        window.addEventListener('online', () => {
            actualizarEstadoConexion();
            console.log('‚úÖ Conexi√≥n restaurada');
        });

        window.addEventListener('offline', () => {
            actualizarEstadoConexion();
            console.log('üìÇ Sin conexi√≥n');
        });

        window.addEventListener('load', () => {
            console.log('üß™ Test iniciado - SIN DEFAULT_DATA');
            console.log('üìä Sheet ID:', SHEET_ID);
            actualizarEstadoConexion();
            verCache();
        });
    </script>
</body>
</html>
‚úÖ Caracter√≠sticas del Test Limpio:
‚úÖ Sin DEFAULT_DATA
No hay valores hardcodeados
Todo se lee desde Google Sheets
Si falla, muestra error claro
‚úÖ Validaciones
Verifica que las hojas existan
Detecta valores inv√°lidos
Muestra errores espec√≠ficos
‚úÖ Mapeo Visual
Muestra fila por fila el mapeo
Compara Dias vs Interes lado a lado
Muestra el resultado final
‚úÖ Cache Inteligente
Guarda con timestamp
Detecta expiraci√≥n (24 horas)
Muestra estado del cache
üéØ Flujo de Uso del Test:
Verificar Conexi√≥n ‚Üí Confirmar que hojas existen
Leer Datos Reales ‚Üí Cargar desde Google Sheets
Ver Mapeo ‚Üí Visualizar c√≥mo se relacionan filas
Guardar en Cache ‚Üí Almacenar en localStorage
Probar C√°lculo ‚Üí Verificar que funciona
üìã Checklist de Google Sheets:
Hoja "Dias"
A1: Dias (opcional)
A2: 27
A3: 40
A4: 54
A5: 68
Hoja "Interes"
A1: Interes (opcional)
A2: 21.5  (o 21.5%)
A3: 32    (o 32%)
A4: 44    (o 44%)
A5: 49.8  (o 49.8%)
Hoja "Capital"
A1: Capital (opcional)
A2: 1000
A3: 2000
A4: 3000
...
Hoja "Banner"
A1: (vac√≠o)
A2: Tu mensaje del banner
¬øEste test limpio es lo que necesitabas? üöÄ
